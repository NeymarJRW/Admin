{"remainingRequest":"/Users/gaga/Desktop/Admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gaga/Desktop/Admin/src/views/Games/Examination.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/gaga/Desktop/Admin/src/views/Games/Examination.vue","mtime":1565682144586},{"path":"/Users/gaga/Desktop/Admin/node_modules/babel-loader/lib/index.js","mtime":1579254436726},{"path":"/Users/gaga/Desktop/Admin/node_modules/cache-loader/dist/cjs.js","mtime":1579254447879},{"path":"/Users/gaga/Desktop/Admin/node_modules/vue-loader/lib/index.js","mtime":1579254448195}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { addGame, User, showIPInfo, updateAuditState, getAllAudit, addUser, editApp } from '@/api/index'\r\nimport { pageApi, timeZero } from '@/util/util'\r\nexport default {\r\n  data() {\r\n    return {\r\n      modal: false,\r\n      record: false,\r\n      upload: false,\r\n      createModal: false,\r\n      modifyName: false,\r\n      form: {\r\n        bundle: '',\r\n        url: '',\r\n        appName: '', // 游戏名称\r\n        gameName: '', // 伪装名称\r\n        user: ''\r\n      },\r\n      createForm: {\r\n        user: ''\r\n      },\r\n      uploadForm: {\r\n        bundle: ''\r\n      },\r\n      gameNameForm: {\r\n        id: '',\r\n        appName: '',\r\n        gameName: ''\r\n      },\r\n      users: [],\r\n      columns: [\r\n        {\r\n          title: 'bundleID',\r\n          key: 'bundleId'\r\n        },\r\n        {\r\n          title: '游戏创建者',\r\n          key: 'userName'\r\n        },\r\n        {\r\n          title: '游戏地址',\r\n          key: 'url',\r\n          render: (h, params) => {\r\n            return h('div', {\r\n              style: {\r\n                color: \"#2D8CF0\",\r\n                cursor: \"pointer\",\r\n                maxWidth: \"200px\",\r\n                textOverflow: \"ellipsis\",\r\n                overflow: \"hidden\",\r\n                whiteSpace: \"nowrap\"\r\n              },\r\n              on: {\r\n                click: () => {\r\n                  window.open(params.row.url)\r\n                }\r\n              },\r\n            }, params.row.url)\r\n          }\r\n        },\r\n        {\r\n          title: '游戏名称',\r\n          key: 'appName'\r\n        },\r\n        {\r\n          title: '游戏伪装名称',\r\n          key: 'gameName'\r\n        },\r\n        {\r\n          title: '创建时间',\r\n          key: 'createTime'\r\n        },\r\n        {\r\n          title: '游戏提审状态',\r\n          key: 'state',\r\n          render: (h, params) => {\r\n            return params.row.state == 0 ? h('div', {\r\n              style: { color: \"#19be6b\" }\r\n            },\"待提审\") : params.row.state == 1 ? h('div', {\r\n              style: { color: \"#ff9900\" }\r\n            }, \"已提审\") : h('div', {\r\n              style: { color: \"#ed4014\" }\r\n            }, \"打回\")\r\n          }\r\n        },\r\n        {\r\n          title: '操作',\r\n          key: '',\r\n          width: 250,\r\n          align: 'center',\r\n          render: (h, params) => {\r\n            return h('div',[\r\n              h('Button',{\r\n                props: {\r\n                  type: 'primary',\r\n                  size: 'small'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.upload = !this.upload\r\n                    this.uploadForm.bundle = params.row.bundleId\r\n                    this.uploadForm.state = [Number(params.row.state)]\r\n                  }\r\n                }\r\n              }, '提审状态'),\r\n              h('Button',{\r\n                props: {\r\n                  type: 'primary',\r\n                  size: 'small'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.record = !this.record\r\n                    showIPInfo({\r\n                      bundle: params.row.bundleId\r\n                    }).then(res => {\r\n                      if(res.code === 1) {\r\n                        var result = res.msg\r\n                        let ipArrs = [], cArr = [] // 初始化空ip 空颜色数组\r\n                        var colorArr = [\"#CC9999\",\"#666699\",\"#FF9900\",\"#0099CC\",\"#CCCC99\",\"#CC3399\",\"#99CC00\",\"#FF6666\",\"#CC6600\",\"#CCCC33\",\"#009966\",\"#FFCC99\",\"#CC0066\",\"#FF0033\",\"#666633\",\"#66CCCC\",\"#FF6666\",\"#FF9966\",\"#333399\",\"#663399\",\"#CC3333\",\"#339999\"]\r\n                        var ran = Math.floor(Math.random() * colorArr.length)\r\n                        for(var i = 0; i < result.length; i++) {\r\n                          if(ipArrs.indexOf(result[i].ip) == -1) {\r\n                            ipArrs.push(result[i].ip)\r\n                            cArr.push(colorArr[ran])\r\n                            result[i].color = colorArr[ran]\r\n                            colorArr.splice(ran, 1)\r\n                          } else {\r\n                            result[i].color = cArr[ipArrs.indexOf(result[i].ip)]\r\n                          }\r\n                        }\r\n                        this.records = result\r\n                      } else {\r\n                        this.records = []\r\n                      }\r\n                    })\r\n                  }\r\n                }\r\n              },'访问记录'),\r\n              h('Button',{\r\n                props: {\r\n                  type: 'primary',\r\n                  size: 'small'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.modifyName = !this.modifyName\r\n                    this.gameNameForm.id = params.row.id\r\n                    this.gameNameForm.appName = params.row.appName\r\n                    this.gameNameForm.gameName = params.row.gameName\r\n                  }\r\n                }\r\n              },'修改名称')\r\n            ])\r\n          }\r\n        }\r\n      ],\r\n      msgs: [],\r\n      datas: [],\r\n      tabledata: [],\r\n      total: 0,\r\n      pageSize: 10,\r\n      states: [\r\n        { id: 0, title: \"待提审\" },\r\n        { id: 1, title: \"已提审\" },\r\n        { id: 2, title: \"打回\" }\r\n      ],\r\n      selectState: [\r\n        { id: 0, label: \"全部\" },\r\n        { id: 1, label: \"只显示已提审\" }\r\n      ],\r\n      stateLabel: 0,\r\n      stateNum: 0,\r\n      value: \"\",\r\n      records: [],\r\n      curPage: 1,\r\n      current: 1,\r\n      currentTime: null\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getData(this.currentTime)\r\n    this.getUser()\r\n  },\r\n  methods: {\r\n    getData(time) {\r\n      this.datas = []\r\n      getAllAudit({\r\n        time: time\r\n      }).then(res => {\r\n        if(res.code === 1) {\r\n          this.msgs = res.msg\r\n          this.total = res.msg.length\r\n          this.datas = pageApi(res.msg, this.pageSize)\r\n          this.tabledata = this.datas[this.curPage - 1]\r\n          if(this.stateNum === 1) {\r\n            this.handle()\r\n          }\r\n        }\r\n      })\r\n    },\r\n    getUser() {\r\n      User().then(res => {\r\n        if(res.code !== -1) this.users = res\r\n      })\r\n    },\r\n    handle() {\r\n      let emptyBox = []\r\n      this.msgs.map(x => {\r\n        if(x.state === \"1\") emptyBox.push(x)\r\n      })\r\n      this.datas = pageApi(emptyBox, this.pageSize)\r\n      this.total = emptyBox.length\r\n      this.msgs = emptyBox\r\n      this.tabledata = this.datas[this.curPage - 1] ? this.datas[this.curPage - 1] : this.datas[0], this.curPage = 1\r\n    },\r\n    showInfo() {\r\n      if(this.value) {\r\n        var datas = []\r\n        for(let i = 0, len = this.msgs.length; i < len; i++) {\r\n          if(this.msgs[i].bundleId.indexOf(this.value) > -1) {\r\n            datas.push(this.msgs[i])\r\n          }\r\n        }\r\n        this.current = 1\r\n        this.tabledata = datas\r\n      } else {\r\n        this.getData(this.currentTime)\r\n      }\r\n    },\r\n    upBring() {\r\n      updateAuditState({\r\n        bundle: this.uploadForm.bundle,\r\n        state: this.uploadForm.state\r\n      }).then(res => {\r\n        if(res.code === 1) {\r\n          this.$Message.success(res.msg)\r\n          this.getData(this.currentTime)\r\n        } else {\r\n          this.$Message.info(res.msg)\r\n        }\r\n      })\r\n    },\r\n    ok () {\r\n      addGame({\r\n        bundle: this.form.bundle,\r\n        user: this.form.user,\r\n        url: this.form.url,\r\n        appName: this.form.appName,\r\n        gameName: this.form.gameName,\r\n        createTime: parseInt(Date.now() / 1000),\r\n        state: 1\r\n      }).then(res => {\r\n        this.$Message.success(res.msg)\r\n        this.getData(this.currentTime)\r\n      })\r\n    },\r\n    craeteUser() {\r\n      if(this.createForm.user) {\r\n        addUser({\r\n          name: this.createForm.user,\r\n          password: this.createForm.password\r\n        }).then(res => {\r\n          if(res.code === 1) {\r\n            this.$Message.success(res.msg)\r\n            this.getUser()\r\n          } else {\r\n            this.$Message.info(res.msg)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    modifyGameName() {\r\n      editApp({\r\n        id: this.gameNameForm.id,\r\n        appName: this.gameNameForm.appName,\r\n        gameName: this.gameNameForm.gameName\r\n      }).then(res => {\r\n        if(res.code === 1) {\r\n          this.$Message.success(res.msg)\r\n          this.getData(this.currentTime)\r\n        } else {\r\n          this.$Message.info(res.msg)\r\n        }\r\n      })\r\n    },\r\n    cancel () {\r\n      this.$Message.info('取消')\r\n    },\r\n    onChange(e) {\r\n      this.curPage = e\r\n      this.tabledata = this.datas[e-1]\r\n    },\r\n    stateChange(e) {\r\n      this.stateNum = e\r\n      if(e === 0) {\r\n        this.getData(this.currentTime)\r\n      } else {\r\n        this.handle()\r\n      }\r\n    },\r\n    dateChange(e) {\r\n      this.currentTime = timeZero(e)\r\n      this.value = \"\"\r\n      this.getData(timeZero(e))\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["Examination.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Examination.vue","sourceRoot":"src/views/Games","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"tools\">\r\n      <div>\r\n        <Button shape=\"circle\" icon=\"ios-arrow-back\" style=\"margin-right:10px\" @click=\"getData(currentTime)\"></Button>\r\n        <Input v-model=\"value\" placeholder=\"bundleId\" style=\"width: 200px\"/>\r\n        <Button shape=\"circle\" icon=\"ios-search\" class=\"tools_btn\" @click=\"showInfo\"></Button>\r\n        <DatePicker type=\"date\" placeholder=\"选择日期\" style=\"margin-left:60px;width: 200px\"\r\n          @on-change=\"dateChange\"></DatePicker>\r\n      </div>\r\n      <div>\r\n        <Select v-model=\"stateLabel\" style=\"width:200px;margin-right:10px\"\r\n          @on-change=\"stateChange\">\r\n          <Option v-for=\"item in selectState\" :value=\"item.id\" :key=\"item.id\">{{ item.label }}</Option>\r\n        </Select>\r\n        <Button type=\"primary\" style=\"margin-right:10px\"\r\n          @click=\"createModal = !createModal\">添加创建者</Button>\r\n        <Button type=\"primary\" @click=\"modal = !modal\">游戏录入</Button>\r\n      </div>\r\n    </div>\r\n    <!-- code -->\r\n    <!-- <transition name=\"fade\">\r\n      <keep-alive>\r\n        <router-view class=\"core\"></router-view>\r\n      </keep-alive>\r\n    </transition> -->\r\n    <div class=\"view\">\r\n      <Table :columns=\"columns\" :data=\"tabledata\"></Table>\r\n      <Page :total=\"total\" :page-size=\"pageSize\" @on-change=\"onChange\" class=\"page_style\" \r\n            :current.sync=\"current\"/>\r\n    </div>\r\n    <!-- 提审游戏录入 -->\r\n    <Modal\r\n      v-model=\"modal\" title=\"提审游戏录入\" \r\n      @on-ok=\"ok\" @on-cancel=\"cancel\" > \r\n      <Form :model=\"form\" label-position=\"right\" :label-width=\"100\">\r\n        <FormItem label=\"游戏bundleID\">\r\n          <Input v-model=\"form.bundle\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"游戏地址\">\r\n          <Input v-model=\"form.url\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"游戏名称\">\r\n          <Input v-model=\"form.appName\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"游戏伪装名\">\r\n          <Input v-model=\"form.gameName\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"游戏创建者\">\r\n          <Select v-model=\"form.user\">\r\n            <Option v-for=\"item in users\" :value=\"item.id\" :key=\"item.id\">{{item.userName}}</Option>\r\n          </Select>\r\n        </FormItem>\r\n      </Form>\r\n    </Modal>\r\n    <!-- 查询访问记录 -->\r\n    <Modal\r\n      v-model=\"record\" title=\"查询访问记录\" footer-hide>\r\n      <Timeline>\r\n        <TimelineItem v-for=\"(item, i) in records\" v-bind:key=\"i\">\r\n          <span class=\"timeline_item\">{{item.time}}</span>\r\n          <span class=\"timeline_item\" :style=\"{ width: '142px', color: item.color }\">{{item.ip}}</span>\r\n          <template>\r\n            <span v-if=\"item.type == 0\" style=\"color:#19be6b\">访问游戏</span>\r\n            <span v-if=\"item.type == 1\" style=\"color:#ff9900\">点击游戏</span>\r\n            <span v-if=\"item.type == 2\" style=\"color:#ed4014\">退出游戏</span>\r\n          </template>\r\n        </TimelineItem>\r\n      </Timeline>\r\n    </Modal>\r\n    <!-- 更新提审状态 -->\r\n    <Modal v-model=\"upload\" title=\"更新提审状态\" @on-ok=\"upBring\">\r\n      <Form :model=\"uploadForm\" label-position=\"right\" :label-width=\"100\">\r\n        <FormItem label=\"游戏bundleID\">\r\n          <Input v-model=\"uploadForm.bundle\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"游戏提审状态\">\r\n          <Select v-model=\"uploadForm.state\">\r\n            <Option v-for=\"item in states\" :value=\"item.id\" :key=\"item.id\">{{item.title}}</Option>\r\n          </Select>\r\n        </FormItem>\r\n      </Form>\r\n    </Modal>\r\n    <!-- 添加创建者 -->\r\n    <Modal v-model=\"createModal\" title=\"添加创建者\" @on-ok=\"craeteUser\">\r\n      <Form :model=\"createForm\" label-position=\"right\" :label-width=\"100\">\r\n        <FormItem label=\"创建者\">\r\n          <Input v-model=\"createForm.user\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"设置密码\">\r\n          <Input v-model=\"createForm.password\"></Input>\r\n        </FormItem>\r\n      </Form>\r\n    </Modal>\r\n    <!-- 修改游戏名称 -->\r\n    <Modal v-model=\"modifyName\" title=\"修改游戏名称\" @on-ok=\"modifyGameName\">\r\n      <Form :model=\"gameNameForm\" label-position=\"right\" :label-width=\"100\">\r\n        <FormItem label=\"游戏名称\">\r\n          <Input v-model=\"gameNameForm.appName\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"游戏伪装名称\">\r\n          <Input v-model=\"gameNameForm.gameName\"></Input>\r\n        </FormItem>\r\n      </Form>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { addGame, User, showIPInfo, updateAuditState, getAllAudit, addUser, editApp } from '@/api/index'\r\nimport { pageApi, timeZero } from '@/util/util'\r\nexport default {\r\n  data() {\r\n    return {\r\n      modal: false,\r\n      record: false,\r\n      upload: false,\r\n      createModal: false,\r\n      modifyName: false,\r\n      form: {\r\n        bundle: '',\r\n        url: '',\r\n        appName: '', // 游戏名称\r\n        gameName: '', // 伪装名称\r\n        user: ''\r\n      },\r\n      createForm: {\r\n        user: ''\r\n      },\r\n      uploadForm: {\r\n        bundle: ''\r\n      },\r\n      gameNameForm: {\r\n        id: '',\r\n        appName: '',\r\n        gameName: ''\r\n      },\r\n      users: [],\r\n      columns: [\r\n        {\r\n          title: 'bundleID',\r\n          key: 'bundleId'\r\n        },\r\n        {\r\n          title: '游戏创建者',\r\n          key: 'userName'\r\n        },\r\n        {\r\n          title: '游戏地址',\r\n          key: 'url',\r\n          render: (h, params) => {\r\n            return h('div', {\r\n              style: {\r\n                color: \"#2D8CF0\",\r\n                cursor: \"pointer\",\r\n                maxWidth: \"200px\",\r\n                textOverflow: \"ellipsis\",\r\n                overflow: \"hidden\",\r\n                whiteSpace: \"nowrap\"\r\n              },\r\n              on: {\r\n                click: () => {\r\n                  window.open(params.row.url)\r\n                }\r\n              },\r\n            }, params.row.url)\r\n          }\r\n        },\r\n        {\r\n          title: '游戏名称',\r\n          key: 'appName'\r\n        },\r\n        {\r\n          title: '游戏伪装名称',\r\n          key: 'gameName'\r\n        },\r\n        {\r\n          title: '创建时间',\r\n          key: 'createTime'\r\n        },\r\n        {\r\n          title: '游戏提审状态',\r\n          key: 'state',\r\n          render: (h, params) => {\r\n            return params.row.state == 0 ? h('div', {\r\n              style: { color: \"#19be6b\" }\r\n            },\"待提审\") : params.row.state == 1 ? h('div', {\r\n              style: { color: \"#ff9900\" }\r\n            }, \"已提审\") : h('div', {\r\n              style: { color: \"#ed4014\" }\r\n            }, \"打回\")\r\n          }\r\n        },\r\n        {\r\n          title: '操作',\r\n          key: '',\r\n          width: 250,\r\n          align: 'center',\r\n          render: (h, params) => {\r\n            return h('div',[\r\n              h('Button',{\r\n                props: {\r\n                  type: 'primary',\r\n                  size: 'small'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.upload = !this.upload\r\n                    this.uploadForm.bundle = params.row.bundleId\r\n                    this.uploadForm.state = [Number(params.row.state)]\r\n                  }\r\n                }\r\n              }, '提审状态'),\r\n              h('Button',{\r\n                props: {\r\n                  type: 'primary',\r\n                  size: 'small'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.record = !this.record\r\n                    showIPInfo({\r\n                      bundle: params.row.bundleId\r\n                    }).then(res => {\r\n                      if(res.code === 1) {\r\n                        var result = res.msg\r\n                        let ipArrs = [], cArr = [] // 初始化空ip 空颜色数组\r\n                        var colorArr = [\"#CC9999\",\"#666699\",\"#FF9900\",\"#0099CC\",\"#CCCC99\",\"#CC3399\",\"#99CC00\",\"#FF6666\",\"#CC6600\",\"#CCCC33\",\"#009966\",\"#FFCC99\",\"#CC0066\",\"#FF0033\",\"#666633\",\"#66CCCC\",\"#FF6666\",\"#FF9966\",\"#333399\",\"#663399\",\"#CC3333\",\"#339999\"]\r\n                        var ran = Math.floor(Math.random() * colorArr.length)\r\n                        for(var i = 0; i < result.length; i++) {\r\n                          if(ipArrs.indexOf(result[i].ip) == -1) {\r\n                            ipArrs.push(result[i].ip)\r\n                            cArr.push(colorArr[ran])\r\n                            result[i].color = colorArr[ran]\r\n                            colorArr.splice(ran, 1)\r\n                          } else {\r\n                            result[i].color = cArr[ipArrs.indexOf(result[i].ip)]\r\n                          }\r\n                        }\r\n                        this.records = result\r\n                      } else {\r\n                        this.records = []\r\n                      }\r\n                    })\r\n                  }\r\n                }\r\n              },'访问记录'),\r\n              h('Button',{\r\n                props: {\r\n                  type: 'primary',\r\n                  size: 'small'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.modifyName = !this.modifyName\r\n                    this.gameNameForm.id = params.row.id\r\n                    this.gameNameForm.appName = params.row.appName\r\n                    this.gameNameForm.gameName = params.row.gameName\r\n                  }\r\n                }\r\n              },'修改名称')\r\n            ])\r\n          }\r\n        }\r\n      ],\r\n      msgs: [],\r\n      datas: [],\r\n      tabledata: [],\r\n      total: 0,\r\n      pageSize: 10,\r\n      states: [\r\n        { id: 0, title: \"待提审\" },\r\n        { id: 1, title: \"已提审\" },\r\n        { id: 2, title: \"打回\" }\r\n      ],\r\n      selectState: [\r\n        { id: 0, label: \"全部\" },\r\n        { id: 1, label: \"只显示已提审\" }\r\n      ],\r\n      stateLabel: 0,\r\n      stateNum: 0,\r\n      value: \"\",\r\n      records: [],\r\n      curPage: 1,\r\n      current: 1,\r\n      currentTime: null\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getData(this.currentTime)\r\n    this.getUser()\r\n  },\r\n  methods: {\r\n    getData(time) {\r\n      this.datas = []\r\n      getAllAudit({\r\n        time: time\r\n      }).then(res => {\r\n        if(res.code === 1) {\r\n          this.msgs = res.msg\r\n          this.total = res.msg.length\r\n          this.datas = pageApi(res.msg, this.pageSize)\r\n          this.tabledata = this.datas[this.curPage - 1]\r\n          if(this.stateNum === 1) {\r\n            this.handle()\r\n          }\r\n        }\r\n      })\r\n    },\r\n    getUser() {\r\n      User().then(res => {\r\n        if(res.code !== -1) this.users = res\r\n      })\r\n    },\r\n    handle() {\r\n      let emptyBox = []\r\n      this.msgs.map(x => {\r\n        if(x.state === \"1\") emptyBox.push(x)\r\n      })\r\n      this.datas = pageApi(emptyBox, this.pageSize)\r\n      this.total = emptyBox.length\r\n      this.msgs = emptyBox\r\n      this.tabledata = this.datas[this.curPage - 1] ? this.datas[this.curPage - 1] : this.datas[0], this.curPage = 1\r\n    },\r\n    showInfo() {\r\n      if(this.value) {\r\n        var datas = []\r\n        for(let i = 0, len = this.msgs.length; i < len; i++) {\r\n          if(this.msgs[i].bundleId.indexOf(this.value) > -1) {\r\n            datas.push(this.msgs[i])\r\n          }\r\n        }\r\n        this.current = 1\r\n        this.tabledata = datas\r\n      } else {\r\n        this.getData(this.currentTime)\r\n      }\r\n    },\r\n    upBring() {\r\n      updateAuditState({\r\n        bundle: this.uploadForm.bundle,\r\n        state: this.uploadForm.state\r\n      }).then(res => {\r\n        if(res.code === 1) {\r\n          this.$Message.success(res.msg)\r\n          this.getData(this.currentTime)\r\n        } else {\r\n          this.$Message.info(res.msg)\r\n        }\r\n      })\r\n    },\r\n    ok () {\r\n      addGame({\r\n        bundle: this.form.bundle,\r\n        user: this.form.user,\r\n        url: this.form.url,\r\n        appName: this.form.appName,\r\n        gameName: this.form.gameName,\r\n        createTime: parseInt(Date.now() / 1000),\r\n        state: 1\r\n      }).then(res => {\r\n        this.$Message.success(res.msg)\r\n        this.getData(this.currentTime)\r\n      })\r\n    },\r\n    craeteUser() {\r\n      if(this.createForm.user) {\r\n        addUser({\r\n          name: this.createForm.user,\r\n          password: this.createForm.password\r\n        }).then(res => {\r\n          if(res.code === 1) {\r\n            this.$Message.success(res.msg)\r\n            this.getUser()\r\n          } else {\r\n            this.$Message.info(res.msg)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    modifyGameName() {\r\n      editApp({\r\n        id: this.gameNameForm.id,\r\n        appName: this.gameNameForm.appName,\r\n        gameName: this.gameNameForm.gameName\r\n      }).then(res => {\r\n        if(res.code === 1) {\r\n          this.$Message.success(res.msg)\r\n          this.getData(this.currentTime)\r\n        } else {\r\n          this.$Message.info(res.msg)\r\n        }\r\n      })\r\n    },\r\n    cancel () {\r\n      this.$Message.info('取消')\r\n    },\r\n    onChange(e) {\r\n      this.curPage = e\r\n      this.tabledata = this.datas[e-1]\r\n    },\r\n    stateChange(e) {\r\n      this.stateNum = e\r\n      if(e === 0) {\r\n        this.getData(this.currentTime)\r\n      } else {\r\n        this.handle()\r\n      }\r\n    },\r\n    dateChange(e) {\r\n      this.currentTime = timeZero(e)\r\n      this.value = \"\"\r\n      this.getData(timeZero(e))\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n.tools \r\n  margin 10px 20px\r\n  display flex\r\n  justify-content space-between\r\n.tools_btn\r\n  margin-left 10px\r\n.timeline_item \r\n  padding-right 50px\r\n  display inline-block\r\n  text-align center\r\n.page_style\r\n  text-align right \r\n  margin-top 10px\r\n</style>\r\n\r\n"]}]}